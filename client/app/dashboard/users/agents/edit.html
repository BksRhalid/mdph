<div class="edit-partenaire">
  <div class="list-header">
    <h2 class="padding-title" ng-if="!user._id">Création d'un agent</h2>
    <h2 class="padding-title" ng-if="user._id">Edition d'un agent</h2>
  </div>
  <form class="form-horizontal" name="form" ng-submit="update(form)" novalidate>
    <div class="form-group required" ng-class="{ 'has-error': form.nom.$invalid && form.$submitted }">
      <div class="col-sm-2 text-right">
        <label for="nom" class="control-label">Nom</label>
      </div>
      <div class="col-sm-10">
          <input id="nom" type="text" name="nom" class="form-control" ng-model="user.name" required />

          <div ng-messages="form.nom.$error" ng-if="form.$submitted">
           <p class="help-block" ng-message='required'>Veuillez entrer votre nom.</p>
          </div>
      </div>
    </div>

    <div class="form-group required" ng-class="{ 'has-error': form.email.$invalid && form.$submitted }">
      <div class="col-sm-2 text-right">
          <label for="email" class="control-label">Email</label>
      </div>
      <div class="col-sm-10">
        <input id="email" type="email" name="email" class="form-control" ng-model="user.email"
          required
          ng-change="resetMongooseError(form, 'email')"
          mongoose-error/>
        <div ng-messages="form.email.$error" ng-if="form.$submitted">
          <p class="help-block" ng-message='required'>Veuillez entrer votre adresse e-mail.</p>
          <p class="help-block" ng-message='email'> Cet email n'est pas valide.</p>
          <p class="help-block" ng-message="mongoose">{{ errors.email }}</p>
        </div>
      </div>
    </div>

    <div class="form-group required" ng-class="{ 'has-error': form.password.$invalid && form.$submitted }" ng-if="!user._id">
      <div class="col-sm-2 text-right">
        <label for="password" class="control-label">Mot de passe</label>
      </div>
      <div class="col-sm-10">
        <input id="password" type="{{inputType}}" name="password" class="form-control"
         ng-model="user.password" required mongoose-error zxcvbn="passwordStrength" zx-min-score="2">

        <div ng-messages="form.password.$error" ng-if="form.$submitted">
          <p id="error-message" ng-message="passwordStrength" class="help-block">Votre mot de passe est d'une robustesse trop faible</p>
        </div>

        <password-strength-bar password="form.password.$viewValue"></password-strength-bar>

        <input type="checkbox" id="checkbox" ng-model="hidePassword" ng-click="toggleType()" />
        <label for="checkbox">Afficher le mot de passe</label>
      </div>
    </div>
    <div class="form-group">
      <label for="secteur" class="col-sm-2 control-label">Secteurs associés</label>
      <div class="col-sm-10">
        <div ng-repeat="secteur in secteurs">
          <label>
            <input type="checkbox" name="secteur"
              ng-value="secteur._id"
              ng-checked="user.secteurs.indexOf(secteur._id) > -1"
              ng-click="toggleSelection(secteur)">
            {{secteur.name}}
          </label>
        </div>
      </div>
    </div>
    <div class="form-group">
      <div class="col-sm-12 text-right">
        <button class="btn btn-danger" ng-if="user._id" type="button" ng-click="delete()">
          <i class="fa fa-remove"></i> Supprimer
        </button>
        <a class="btn btn-default" ui-sref="^">Annuler</a>
        <button class="btn btn-primary" type="submit">
            <i class="fa fa-save"></i> Enregistrer
          </button>
      </div>
    </div>
  </form>
</div>
